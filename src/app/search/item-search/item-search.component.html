<div class="container-fluid">
    <div class="card card-outline-primary text-right m-1">
        <div class="card-header">
            <h4 class="card-title">search 4 items</h4>
        </div>
        <div class="card-block">
            <div class="form-group row w-100">
                <div class="col-sm-5">
                    <input class="form-control form-control-sm" type="text" name="selectedField" [(ngModel)]="selectedField" (keyup)="filter(selectedField)"
                        id="selectedField">
                    <div *ngIf="filteredTerms.length > 0">
                        <ul class="list-group" *ngFor="let term of filteredTerms" (clickOutside)="close()">
                            <li class="list-group-item-action text-left" (click)="select(term)"><small>{{term}}</small></li>
                        </ul>
                    </div>
                </div>
                <div class="col-sm-5">
                    <input class="form-control form-control-sm" type="text" name="searchTerm" [(ngModel)]="searchTerm" (keyup.enter)="searchItems(selectedField, searchTerm)"
                        id="searchTerm">
                </div>
                <div class="col-sm-2">
                    <input type="submit" class="btn btn-primary btn-sm float-right" name="go" value="go" (click)="searchItems(selectedField, searchTerm)"
                    />
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-3">
            <!--<div class="card-deck w-100">-->
            <div class="card card-outline-primary text-right m-1">
                <!--<div class="card-header">-->
                <div class="row">
                    <label for="aggregationSelect" class="col-4 col-form-label col-form-label-sm"><span class="align-bottom">group by</span></label>
                    <div class="col-8">
                        <select class="select form-control form-control-sm" name="aggregationSelect" (change)="onAggregationSelect($event.target.value)">
                            <option *ngFor="let agg of aggregationsList" [value]="agg">{{agg}}</option>
                        </select>
                    </div>
                </div>
                <!--</div>-->
            </div>
            <div *ngIf="selected === 'creationDate'" class="card card-outline-primary text-right m-1">
                <div class="card-header">
                    <h4 class="card-title">items / creationDate</h4>
                </div>
                <ul class="list-group list-group-flush h-100">
                    <li silver class="list-group-item text-primary p-1 justify-content-end" *ngFor="let year of years" (click)="onSelectYear(year)">
                        <span class="badge badge-primary">{{year.doc_count}}</span>
                        <span class="text-primary ml-2">{{year.key_as_string.substring(0,4)}}</span>
                        <li>
                </ul>
            </div>
            <div *ngIf="selected === 'genre'" class="card card-outline-primary text-right m-1">
                <div class="card-header">
                    <h4 class="card-title">items / genre</h4>
                </div>
                <ul class="list-group list-group-flush h-100">
                    <li silver class="list-group-item text-primary p-1 justify-content-end" *ngFor="let genre of genres" (click)="onSelectGenre(genre)">
                        <span class="text-primary mr-2">{{genre.key}}</span>
                        <span class="badge badge-primary">{{genre.doc_count}}</span>
                        <li>
                </ul>
            </div>
            <div *ngIf="selected === 'publisher'" class="card card-outline-primary text-right m-1">
                <div class="card-header">
                    <h4 class="card-title">items / publisher</h4>
                </div>
                <ul class="list-group list-group-flush h-100">
                    <li silver class="list-group-item text-primary p-1 justify-content-end" *ngFor="let publisher of publishers" (click)="onSelectPublisher(publisher)">
                        <span class="text-primary mr-2">{{publisher.key}}</span>
                        <span class="badge badge-primary">{{publisher.doc_count}}</span>
                        <li>
                </ul>
            </div>
            <!--</div>-->
        </div>
        <div class="col-9">
            <div>
                <span class="text-primary">your query returned {{total}} records</span>
                <span *ngIf="total > 10000" class="text-primary">(but you can only view 10.000)</span>
                <div *ngIf="total > 0" class="has-text-centered">
                    <div class="spinner" [ngClass]="{ 'hidden': !loading }"></div>
                    <pagination-controls class="admin-pagination" previousLabel="prev" nextLabel="next" maxSize=11 autoHide="true" (pageChange)="getPage($event, selectedField, searchTerm)" id="paginator"></pagination-controls>
                </div>
                <ul class="list-group list-group-flush h-100">
                    <li silver class="list-group-item text-primary justify-content-start p-1" *ngFor="let item of items | paginate: { id: 'paginator', itemsPerPage: pageSize, currentPage: currentPage, totalItems: total }" (click)="onSelect(item)">
                        <span class="text-primary">{{item.version.objectId}}</span>
                        <span class="text-primary ml-2">{{item.metadata.genre}}</span>

                        <span class="text-primary ml-2">{{item.metadata.title}}</span>
                        <span class="text-primary ml-2">{{item.creationDate}}</span>
                        <span *ngIf="item.metadata.sources" class="text-primary ml-2">{{item.metadata.sources[0]?.publishingInfo?.publisher}}</span>

                        <li>
                </ul>
            </div>
        </div>
    </div>
</div>