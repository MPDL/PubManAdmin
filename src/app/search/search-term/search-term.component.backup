import { Component, AfterViewInit, Input, Output, EventEmitter } from '@angular/core';

@Component({
  selector: 'app-search-term',
  templateUrl: './search-term.component.html',
  styleUrls: ['./search-term.component.scss']
})
export class SearchTermComponent implements AfterViewInit {

  searchTerm: string;
  selectedField: string;
  filteredTerms: string[] = [];
  @Input() fields2Select: string[] = [];
  @Output() searchTermChange = new EventEmitter<string>();
  @Output() selectedFieldChange = new EventEmitter<string>();
  @Output() notice = new EventEmitter<string>();

  constructor() { }

  ngAfterViewInit() {
  }

  filter() {
    if (this.selectedField !== "") {
      this.filteredTerms = this.fields2Select.filter((el) => {
        return el.toLowerCase().indexOf(this.selectedField.toLowerCase()) > -1;
      });
    } else {
      this.filteredTerms = [];
    }
  }

  select(term) {
    this.selectedField = term;
    this.filteredTerms = [];
  }

  close() {
    this.selectedField = "";
    this.filteredTerms = [];
  }

  searchItems(field, term) {
    this.selectedFieldChange.emit(field);
    this.searchTermChange.emit(term);
  }

  addSearchTerm() {
    this.notice.emit("add");
  }

  removeSearchTerm() {
    this.notice.emit("remove");
  }


}
