<div class="container" *ngIf="selected">
    <div class="card card-inverse card-primary text-right">
        <div class="card-block">
            <h4 class="card-title">{{selected.userid}}</h4>
        </div>
        <form class="list-group-item text-primary" name="form" (ngSubmit)="f.form.valid && save()" #f="ngForm" novalidate>
            <div class="form-group row w-100">
                <label for="selected-userid" class="col-2 col-form-label col-form-label-sm">userid</label>
                <div class="col-6">
                    <input class="form-control form-control-sm" type="text" name="userid" [(ngModel)]="selected.userid" id="selected-userid"
                        [readonly]="!isNewUser">
                </div>
                <label *ngIf="!isNewUser" for="selected-id" class="col-1 col-form-label col-form-label-sm">id</label>
                <div *ngIf="!isNewUser" class="col-3">
                    <input class="form-control form-control-sm" type="text" name="id" [(ngModel)]="selected.reference.objectId" id="selected-id"
                        readonly>
                </div>
            </div>
            <div class="form-group row w-100">
                <label for="selected-password" class="col-2 col-form-label col-form-label-sm">password</label>
                <div class="col-6">
                    <input class="form-control form-control-sm" type="password" name="password" [(ngModel)]="selected.password" id="selected-password"
                        readonly>
                </div>
                <div class="col-4">
                    <input type="button" class="btn btn-outline-primary btn-sm float-right" (click)="resetPassword(selected)" name="resetPassword"
                        value="reset" />
                </div>
            </div>
            <div class="form-group row w-100">
                <label for="selected-active" class="col-2 col-form-label col-form-label-sm">active</label>
                <div class="col-6">
                    <input class="form-control form-control-sm" type="text" name="active" [(ngModel)]="selected.active" id="selected-active"
                        readonly>
                </div>
                <div class="col-4">
                    <input type="button" class="btn btn-outline-primary btn-sm float-right" (click)="activateUser(selected)" name="activate"
                        [value]="selected.active === false ? 'activate' : 'deactivate'" />
                </div>
            </div>
            <div class="form-group row w-100">
                <label for="selected-name" class="col-2 col-form-label col-form-label-sm">name</label>
                <div class="col-10">
                    <input class="form-control form-control-sm" type="text" name="name" [(ngModel)]="selected.name" id="selected-name">
                </div>
            </div>
            <div class="form-group row w-100">
                <label for="selected-email" class="col-2 col-form-label col-form-label-sm">email</label>
                <div class="col-10">
                    <input class="form-control form-control-sm" type="email" name="email" [(ngModel)]="selected.email" id="selected-email">
                </div>
            </div>
            <div *ngIf="!isNewOu" class="form-group row w-100">
                <label for="selected-ou" class="col-2 col-form-label col-form-label-sm">organization</label>
                <div *ngIf="selected.affiliations[0] != null" class="col-6">
                    <input class="form-control form-control-sm" type="text" name="ouid" [(ngModel)]="selected.affiliations[0].title" id="selected-ou" readonly>
                </div>
                <div class="col-4">
                    <input type="button" class="btn btn-outline-primary btn-sm float-right" (click)="onChangeOu()" name="changeou"
                        value="change" />
                </div>
            </div>
            <div *ngIf="isNewUser || isNewOu" class="form-group row w-100">
                <label for="ou2select" class="col-2 col-form-label col-form-label-sm">organization</label>
                <div class="col-10">
                    <select id="ou2select" class="select form-control form-control-sm" [(ngModel)]="selectedOu" (ngModelChange)="onSelectOu($event)"
                        name="selectedOu">
			<option [ngValue]="ou" *ngFor="let ou of ous">{{ou.defaultMetadata.name}}</option>
			</select>
                </div>
            </div>
            <div class="form-group row w-100">
                <div class="col-2 offset-10">
                    <input type="button" class="btn btn-outline-primary btn-sm" name="cancel" value="cancel" (click)="gotoList()" />
                    <input type="button" class="btn btn-outline-primary btn-sm" name="save" value="save" (click)="save(selected)" />
                </div>
            </div>
            <div *ngIf="!isNewUser" class="w-100">
                <div class="form-group row w-100">
                    <label for="addGrantButton" class="col-2 col-form-label col-form-label-sm">grants</label>
                    <div class="col-10 text-right">
                        <ul class="list-group">
                            <li class="list-group-item row p-0" *ngFor="let usergrant of selected.grants">
                                <label class="col-3 col-form-label-sm my-auto text-left">{{usergrant.role}}</label>
                                <label class="col-8 col-form-label-sm my-auto text-left">{{usergrant.objectRef}}</label>
                                <span class="col-1"><input type="button" class="btn btn-outline-primary btn-sm" (click)="deleteGrant(usergrant); $event.stopPropagation()"
                                            name="deleteGrant" value="x" /></span>
                            </li>
                        </ul>
                    </div>
                </div>
                <div *ngIf="!isNewGrant" class="form-group row w-100">

                    <div class="col-2 offset-10">
                        <input type="button" class="btn btn-outline-primary btn-sm float-right" (click)="addGrant(); $event.stopPropagation()" name="addGrant"
                            value="add grants" />
                    </div>
                </div>
                <div *ngIf="isNewGrant" class="form-group row w-100">
                    <grants [(selectedUser)]="selected" [token]="token" [(isNewGrant)]="isNewGrant"></grants>
                </div>
                <div *ngIf="grants2remove" class="form-group row w-100">
                    <div class="form-group row offset-2 w-100">
                        <div class="col-9">
                            <textarea class="form-control form-control-sm" rows="3" name="grantsToRemove" [(ngModel)]="grantsToRemove"></textarea>
                        </div>
                        <div class="col-3">
                            <input type="button" class="btn btn-outline-primary btn-sm float-left" name="removeGrants" value="remove grants" (click)="removeGrants()"
                            />
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>